<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãŸãã¡ã‚ƒã‚“ã®èµ¤ã„ã‚µãƒ³ã‚·ãƒ§ã‚¦ã‚¦ã‚ªï¼šã¦ã‚“ã‹ã‚“é‡ç©ã‚¯ã‚¤ã‚º</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Nunito', sans-serif; /* å¯æ„›ã‚‰ã—ã„ãƒ•ã‚©ãƒ³ãƒˆ */
            background-color: #fce7f3; /* æ¡œè‰²ã®ã‚ˆã†ãªå„ªã—ã„èƒŒæ™¯ */
            color: #333;
            line-height: 1.6;
        }
        .game-container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 25px; /* ã‚ˆã‚Šä¸¸ã¿ã‚’å¸¯ã³ãŸè§’ */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15); /* å¼·ã‚ã®å½± */
        }
        .question-area {
            min-height: 150px;
            background-color: #e0f2fe; /* è–„ã„é’ */
            border: 3px dashed #ef4444; /* èµ¤ã„ç‚¹ç·šãƒœãƒ¼ãƒ€ãƒ¼ */
            border-radius: 20px;
            padding: 25px;
        }
         .answer-choices button {
            background-color: #a7f3d0; /* è–„ã„ç·‘ã®ãƒœã‚¿ãƒ³ */
            color: #065f46;
            font-weight: 600;
            padding: 14px 25px; /* ãƒœã‚¿ãƒ³ã‚’å¤§ãã */
            border-radius: 15px; /* ä¸¸ã¿ã‚’å¸¯ã³ãŸãƒœã‚¿ãƒ³ */
            box-shadow: 0 5px 8px rgba(0, 0, 0, 0.1);
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .answer-choices button:hover {
            background-color: #6ee7b7; /* ãƒ›ãƒãƒ¼ã§æ¿ƒã„ç·‘ */
            transform: translateY(-3px);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.2);
        }
        .answer-choices button:active {
            transform: translateY(0);
            box-shadow: 0 5px 8px rgba(0, 0, 0, 0.1);
        }
         .answer-choices button.bg-green-500 {
            background-color: #34d399; /* æ­£è§£æ™‚ã®ç·‘ */
             color: white;
        }
        .answer-choices button.bg-red-500 {
            background-color: #f87171; /* ä¸æ­£è§£æ™‚ã®èµ¤ */
             color: white;
        }

        .feedback-area {
            min-height: 100px; /* ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚¨ãƒªã‚¢ã‚’å°ã•ã */
            background-color: #bfdbfe; /* è–„ã„æ°´è‰² */
            border-left: 8px solid #ef4444; /* å¼·èª¿ã•ã‚ŒãŸèµ¤ã„å·¦ãƒœãƒ¼ãƒ€ãƒ¼ */
            border-radius: 20px;
            padding: 25px;
        }
        .progress-bar-container {
            width: 100%;
            background-color: #e2e8f0;
            border-radius: 9999px;
            margin-top: 25px;
            height: 25px; /* ãƒãƒ¼ã‚’ã•ã‚‰ã«å¤ªã */
            overflow: hidden;
            box-shadow: inset 0 3px 6px rgba(0, 0, 0, 0.1);
        }
        .progress-bar {
            height: 100%;
            background-image: linear-gradient(to right, #ef4444, #fca5a5); /* èµ¤ç³»ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ */
            border-radius: 9999px;
            transition: width 0.5s ease-in-out;
            text-align: center;
            color: white;
            font-size: 1rem;
            line-height: 25px;
            font-weight: bold;
        }
        .xp-level {
            margin-top: 15px;
            font-size: 1.1rem;
            text-align: right;
            color: #4b5563;
            font-weight: 700;
        }
        #game-intro button,
        #game-end button {
            background-color: #f97316; /* ã‚ªãƒ¬ãƒ³ã‚¸ç³»ã®ãƒœã‚¿ãƒ³ */
            color: white;
            font-weight: bold;
            padding: 15px 30px; /* ãƒœã‚¿ãƒ³ã‚’ã•ã‚‰ã«å¤§ãã */
            border-radius: 15px;
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
             transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out, box-shadow 0.2s ease-in-out;
        }
         #game-intro button:hover,
        #game-end button:hover {
             background-color: #ea580c; /* ãƒ›ãƒãƒ¼ã§æ¿ƒã„ã‚ªãƒ¬ãƒ³ã‚¸ */
             transform: translateY(-3px);
             box-shadow: 0 8px 12px rgba(0, 0, 0, 0.2);
        }
         #game-intro button:active,
        #game-end button:active {
             transform: translateY(0);
             box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }

        #game-end .bg-yellow-500 { /* å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ */
             background-color: #facc15;
             color: #854d0e;
        }
         #game-end .bg-yellow-500:hover {
             background-color: #eab308;
             color: #713f12;
        }
         #game-end .bg-blue-500 { /* ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ãƒœã‚¿ãƒ³ */
             background-color: #3b82f6;
             color: white;
        }
         #game-end .bg-blue-500:hover {
             background-color: #2563eb;
        }


        #incorrect-answers-summary {
            background-color: #fee2e2; /* è–„ã„èµ¤ */
            border-left-color: #ef4444; /* èµ¤ã®ãƒœãƒ¼ãƒ€ãƒ¼ */
            border-radius: 15px;
            padding: 20px;
        }

        h1, h2, h3, h4 {
            color: #881337; /* è¦‹å‡ºã—ã®è‰²ã‚’èµ¤ç³»ã« */
        }

    </style>
</head>
<body class="p-4">
    <div class="game-container">
        <h1 class="text-3xl font-bold text-center mb-6">ãŸãã¡ã‚ƒã‚“ã®èµ¤ã„ã‚µãƒ³ã‚·ãƒ§ã‚¦ã‚¦ã‚ªï¼šã¦ã‚“ã‹ã‚“é‡ç©ã‚¯ã‚¤ã‚º</h1>

        <div id="game-intro">
            <p class="mb-4">ç ”ä¿®åŒ»ã®ãŸãã¡ã‚ƒã‚“ã€å›ã¯æ—¥ã€…ã®å¿™ã—ã•ã«è¿½ã‚ã‚Œã‚‹ä¸­ã§ã€å°å…ã®ã¦ã‚“ã‹ã‚“é‡ç©çŠ¶æ…‹ã«é–¢ã™ã‚‹çŸ¥è­˜ã‚’ã‚¯ã‚¤ã‚ºå½¢å¼ã§è©¦ã™ã“ã¨ã«ã—ãŸã€‚ã•ã‚ã€å•é¡Œã«æŒ‘æˆ¦ã—ã¦ã€çŸ¥è­˜ã‚’æ·±ã‚ã‚ˆã†ï¼</p>
            <p class="mb-4 text-center">ã‚¯ã‚¤ã‚ºã‚’é–‹å§‹ã™ã‚‹ã«ã¯ã€ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚</p>
            <button id="start-game-btn" class="block mx-auto">ã‚¯ã‚¤ã‚ºã‚’é–‹å§‹ã™ã‚‹</button>
        </div>

        <div id="game-area" class="hidden">
            <div class="progress-bar-container">
                <div id="progress-bar" class="progress-bar" style="width: 0%;">0%</div>
            </div>
            <div id="xp-level" class="xp-level">XP: 0 | ãƒ¬ãƒ™ãƒ«: 1 | ç§°å·: è¦‹ç¿’ã„ç ”ä¿®åŒ»</div>

            <div id="question-display" class="mb-6 question-area">
                <h2 id="question-text" class="text-xl font-semibold mb-4"></h2>
                <div id="answer-choices" class="flex flex-col space-y-3">
                    </div>
            </div>

            <div id="feedback-display" class="hidden mb-6 feedback-area">
                <h3 id="feedback-title" class="text-2xl font-semibold mb-3"></h3>
                <p id="feedback-text" class="mb-4"></p>
                <div id="supplementary-learning">
                    <h4 class="font-semibold mt-3 text-lg">è£œè¶³å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ:</h4>
                    <ul id="supplementary-list" class="list-disc list-inside ml-4 space-y-1">
                        </ul>
                </div>
                <button id="next-question-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow-md mt-4">æ¬¡ã®å•é¡Œã¸</button>
            </div>
        </div>

        <div id="game-end" class="hidden text-center">
            <h2 class="text-3xl font-bold mb-4">ã‚¯ã‚¤ã‚ºçµ‚äº†ï¼</h2>
            <p id="final-score" class="text-lg mb-2"></p>
            <p id="final-xp-level" class="text-lg mb-4"></p>
            <div id="badges-earned" class="mb-6">
                <h3 class="text-2xl font-semibold mb-3">ç²å¾—ã—ãŸãƒãƒƒã‚¸:</h3>
                <ul id="badge-list" class="list-none p-0 space-y-1">
                    </ul>
            </div>
            <div id="incorrect-answers-summary" class="mb-6 text-left">
                <h3 class="text-2xl font-semibold mb-3">å¼±ç‚¹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯:</h3>
                <p id="weakness-feedback" class="mb-3"></p>
                <ul id="incorrect-list" class="list-disc list-inside ml-4 space-y-2">
                    </ul>
            </div>
            <div class="flex justify-center space-x-4 mt-6">
                 <button id="review-mode-btn" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg shadow-md">å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰</button>
                 <button id="restart-game-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md">ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹</button>
            </div>
            <div class="mt-6 text-sm text-gray-600">
                 <label for="shuffle-questions" class="mr-2">å•é¡Œé †ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«:</label>
                 <input type="checkbox" id="shuffle-questions" class="mr-4 accent-blue-500">
                 <label for="shuffle-choices" class="mr-2">é¸æŠè‚¢é †ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«:</label>
                 <input type="checkbox" id="shuffle-choices" class="accent-blue-500">
            </div>
        </div>
    </div>

    <script>
        // ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ï¼ˆå•é¡Œã€å›ç­”ã€ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼‰
        // ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚„ä¼šè©±ã¯å‰Šé™¤ã—ã€å•é¡Œã¨ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ†ã‚­ã‚¹ãƒˆã®ã¿ã«
        const gameData = [
            {
                chapter: "ãƒ™ãƒ³ã‚¾ã‚¸ã‚¢ã‚¼ãƒ”ãƒ³ã‚’â€œæ—©ãâ€ä½¿ã†ç†ç”±",
                questions: [
                    {
                        text: "ã¦ã‚“ã‹ã‚“ç™ºä½œãŒ10åˆ†ä»¥ä¸Šç¶šãã¨ã€ç¥çµŒç´°èƒã§ä½•ãŒèµ·ã“ã‚Šã€ãƒ™ãƒ³ã‚¾ã‚¸ã‚¢ã‚¼ãƒ”ãƒ³ç³»è–¬ã®åŠ¹æœãŒä½ä¸‹ã™ã‚‹ã¨èª¬æ˜ã•ã‚Œã¾ã—ãŸã‹ï¼Ÿ",
                        choices: ["GABA_Aå—å®¹ä½“ãŒç´°èƒå¤–ã«å¢—ãˆã‚‹", "GABA_Aå—å®¹ä½“ãŒå†…å´ã«å–ã‚Šè¾¼ã¾ã‚Œã‚‹ï¼ˆå†…åœ¨åŒ–ï¼‰", "Clâ»ãƒãƒ£ãƒãƒ«ãŒé–‰ã˜ã‚‹", "ç¥çµŒä¼é”ç‰©è³ªã®æ”¾å‡ºãŒå¢—ãˆã‚‹"],
                        answer: "GABA_Aå—å®¹ä½“ãŒå†…å´ã«å–ã‚Šè¾¼ã¾ã‚Œã‚‹ï¼ˆå†…åœ¨åŒ–ï¼‰",
                        feedbackTitle: "æ­£è§£ï¼",
                        feedbackText: "ãã®é€šã‚Šï¼ç¥çµŒç´°èƒã¯å—å®¹ä½“ã‚’å†…åœ¨åŒ–ã•ã›ã€è–¬ã®åŠ¹ããŒæ‚ªããªã‚‹ã‚“ã ã€‚",
                        supplementary: [
                            "**å†…åœ¨åŒ–:** è–¬å‰¤ã®æ¨™çš„ã¨ãªã‚‹å—å®¹ä½“ãŒç´°èƒå†…ã«å–ã‚Šè¾¼ã¾ã‚Œã‚‹ã“ã¨ã§ã€è–¬ãŒä½œç”¨ã™ã‚‹å ´æ‰€ãŒæ¸›ã‚Šã€åŠ¹æœãŒä½ä¸‹ã™ã‚‹ç¾è±¡ã§ã™ã€‚",
                            "**æ™‚é–“ã¨ã®æˆ¦ã„:** ã“ã®å†…åœ¨åŒ–ãŒèµ·ã“ã‚‹å‰ã«ã€ã¤ã¾ã‚Šç™ºä½œæ—©æœŸã«ãƒ™ãƒ³ã‚¾ã‚¸ã‚¢ã‚¼ãƒ”ãƒ³ã‚’æŠ•ä¸ã™ã‚‹ã“ã¨ãŒã€æ²»ç™‚æˆåŠŸã®éµã¨ãªã‚Šã¾ã™ã€‚"
                        ]
                    }
                ]
            },
            {
                chapter: "æ™‚é–“ã«å¿œã˜ãŸæ²»ç™‚ã‚¹ãƒ†ãƒƒãƒ—",
                questions: [
                    {
                        text: "ç—™æ”£é–‹å§‹ã‹ã‚‰0ã€œ5åˆ†ã®ã€Œè¦³å¯Ÿã¨æº–å‚™ã€ã®æ®µéšã§ã€ç‰¹ã«é‡è¦è¦–ã™ã¹ã3ã¤ã®åˆæœŸå¯¾å¿œã¯ä½•ã§ã™ã‹ï¼Ÿ",
                        choices: ["å¿ƒè‡“ãƒãƒƒã‚µãƒ¼ã‚¸ã€AEDæº–å‚™ã€è¼¸è¡€æº–å‚™", "é…¸ç´ æŠ•ä¸ã€è¡€ç³–æ¸¬å®šã€é™è„ˆè·¯ç¢ºä¿", "é ­éƒ¨CTã€é«„æ¶²æ¤œæŸ»ã€è„³æ³¢æ¸¬å®š", "æŠ—ç”Ÿå‰¤æŠ•ä¸ã€æŠ—ã‚¦ã‚¤ãƒ«ã‚¹å‰¤æŠ•ä¸ã€ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰æŠ•ä¸"],
                        answer: "é…¸ç´ æŠ•ä¸ã€è¡€ç³–æ¸¬å®šã€é™è„ˆè·¯ç¢ºä¿",
                        feedbackTitle: "æ­£è§£ï¼",
                        feedbackText: "ãã®é€šã‚Šï¼ã“ã®æ™‚ç‚¹ã§ã¯â€œè¦‹ã‚‹â€ã“ã¨ãŒé‡è¦ã ãŒã€æ­¢ã¾ã‚‰ãªã‘ã‚Œã°ã™ãã«â€œå‹•ãâ€ã¹ãã ã€‚",
                        supplementary: [
                            "**åˆæœŸå¯¾å¿œã®ABC:** æ•‘å‘½å‡¦ç½®ã®åŸºæœ¬ã§ã‚ã‚Šã€ã¦ã‚“ã‹ã‚“é‡ç©çŠ¶æ…‹ã§ã‚‚åŒæ§˜ã«é‡è¦ã§ã™ã€‚ç‰¹ã«ä½è¡€ç³–ã¯ç—™æ”£ã®å¯é€†çš„ãªåŸå› ã¨ãªã‚‹ãŸã‚ã€è¿…é€Ÿãªè¡€ç³–æ¸¬å®šãŒå¿…é ˆã§ã™ã€‚"
                        ]
                    },
                    {
                        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¦æœ›ã«åˆã‚ã›ã¦æ­£è§£ã‚’ã€Œ2å›ã€ã«å¤‰æ›´
                        text: "ç—™æ”£é–‹å§‹ã‹ã‚‰5ã€œ10åˆ†ã®ã€Œãƒ™ãƒ³ã‚¾ã‚¸ã‚¢ã‚¼ãƒ”ãƒ³ã®æ™‚é–“ã€ã«ãŠã„ã¦ã€ãƒ™ãƒ³ã‚¾ã‚¸ã‚¢ã‚¼ãƒ”ãƒ³ç³»è–¬ã®å†æŠ•ä¸ã¯æœ€å¤§ä½•å›ã¾ã§ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ",
                        choices: ["1å›", "2å›", "3å›", "åˆ¶é™ãªã—"],
                        answer: "2å›", // æ­£è§£ã‚’ã€Œ2å›ã€ã«å¤‰æ›´
                        feedbackTitle: "æ­£è§£ï¼",
                        feedbackText: "ãã®é€šã‚Šï¼åŠ¹ã‹ãªã„ã¨æ„Ÿã˜ãŸã‚‰ã€ã™ãã«æ¬¡ã¸é€²ã‚€åˆ¤æ–­ãŒé‡è¦ã ã€‚",
                        supplementary: [
                            "**å†æŠ•ä¸ã®åˆ¶é™:** ãƒ™ãƒ³ã‚¾ã‚¸ã‚¢ã‚¼ãƒ”ãƒ³ç³»è–¬ã¯å³åŠ¹æ€§ãŒã‚ã‚Šã¾ã™ãŒã€åŠ¹æœãŒãªã‘ã‚Œã°å—å®¹ä½“å†…åœ¨åŒ–ã®å¯èƒ½æ€§ãŒé«˜ãã€æ¼«ç„¶ã¨ç¹°ã‚Šè¿”ã™ã®ã¯é¿ã‘ã‚‹ã¹ãã§ã™ã€‚æ¬¡ã®æ²»ç™‚ã‚¹ãƒ†ãƒƒãƒ—ã¸è¿…é€Ÿã«ç§»è¡Œã™ã‚‹ã“ã¨ãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚",
                            "**è‡¨åºŠçš„ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³:** å¤šãã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã¯ã€ãƒ™ãƒ³ã‚¾ã‚¸ã‚¢ã‚¼ãƒ”ãƒ³ã®å†æŠ•ä¸ã¯1å›ã¾ã§ã¨ã—ã€åˆè¨ˆ2å›ï¼ˆåˆå›ï¼‹å†æŠ•ä¸ï¼‰ã§åŠ¹æœãŒãªã‘ã‚Œã°æ¬¡ã®è–¬å‰¤ã¸ç§»è¡Œã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¦ã„ã¾ã™ã€‚"
                        ]
                    },
                    {
                        text: "ç—™æ”£é–‹å§‹ã‹ã‚‰10ã€œ30åˆ†ã®ã€Œç¬¬äºŒé¸æŠè–¬ã€ã®æ®µéšã§æ¨å¥¨ã•ã‚Œã‚‹è–¬å‰¤ã®ä¸€ã¤ã€ãƒ›ã‚¹ãƒ•ã‚§ãƒ‹ãƒˆã‚¤ãƒ³ï¼ˆfPHTï¼‰ã®ä½œç”¨æ©Ÿåºã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
                        choices: ["GABA_Aå—å®¹ä½“ã‚’ç›´æ¥é–‹å£ã•ã›ã‚‹", "ã‚·ãƒŠãƒ—ã‚¹å°èƒã‚¿ãƒ³ãƒ‘ã‚¯SV2Aã«çµåˆã™ã‚‹", "é›»ä½ä¾å­˜æ€§ãƒŠãƒˆãƒªã‚¦ãƒ ãƒãƒ£ãƒãƒ«ã‚’é®æ–­ã—ã€ä¸æ´»æ€§åŒ–çŠ¶æ…‹ã‚’å®‰å®šåŒ–ã™ã‚‹", "ã‚»ãƒ­ãƒˆãƒ‹ãƒ³å†å–ã‚Šè¾¼ã¿ã‚’é˜»å®³ã™ã‚‹"],
                        answer: "é›»ä½ä¾å­˜æ€§ãƒŠãƒˆãƒªã‚¦ãƒ ãƒãƒ£ãƒãƒ«ã‚’é®æ–­ã—ã€ä¸æ´»æ€§åŒ–çŠ¶æ…‹ã‚’å®‰å®šåŒ–ã™ã‚‹",
                        feedbackTitle: "æ­£è§£ï¼",
                        feedbackText: "ãã®é€šã‚Šï¼Naãƒãƒ£ãƒãƒ«é®æ–­è–¬ã¯ã€èˆˆå¥®ä¼é”ã®æŠ‘åˆ¶ã«æœ‰åŠ¹ã ã€‚",
                        supplementary: [
                            "**ãƒ›ã‚¹ãƒ•ã‚§ãƒ‹ãƒˆã‚¤ãƒ³ (fPHT):** ãƒ•ã‚§ãƒ‹ãƒˆã‚¤ãƒ³ã®ãƒ—ãƒ­ãƒ‰ãƒ©ãƒƒã‚°ã§ã€ä½“å†…ã§ãƒ•ã‚§ãƒ‹ãƒˆã‚¤ãƒ³ã«åŠ æ°´åˆ†è§£ã•ã‚Œã¦åŠ¹æœã‚’ç™ºæ®ã—ã¾ã™ã€‚è¡€ç®¡åˆºæ¿€ãŒå°‘ãªãã€é™è„ˆæŠ•ä¸ã«é©ã—ã¦ã„ã¾ã™ã€‚",
                            "**ä½œç”¨æ©Ÿåº:** ç¥çµŒç´°èƒã®èˆˆå¥®ã‚’æŠ‘ãˆã‚‹ã“ã¨ã§ã€ç™ºä½œã®ä¼æ’­ã‚’é˜»æ­¢ã—ã¾ã™ã€‚"
                        ]
                    },
                    {
                        text: "ç—™æ”£ãŒ30åˆ†ä»¥ä¸Šç¶šãã€Œé›£æ²»æ€§SEï¼ˆRSEï¼‰ã€ã®æ®µéšã§ç”¨ã„ã‚‰ã‚Œã‚‹ãƒã‚ªãƒšãƒ³ã‚¿ãƒ¼ãƒ«ã¯ã€ã©ã®ã‚ˆã†ãªç‰¹å¾´ã‚’æŒã¤è–¬å‰¤ã§ã™ã‹ï¼Ÿ",
                        choices: ["å‘¼å¸æŠ‘åˆ¶ã‚„å¾ªç’°æŠ‘åˆ¶ã®ãƒªã‚¹ã‚¯ãŒä½ã„", "GABA_Aå—å®¹ä½“ã‚’ç›´æ¥é–‹å£ã•ã›ã€æ·±ã„é®é™ã€œæ˜ç¡çŠ¶æ…‹ã¸å°ã", "æ„è­˜æ¸…æ˜ãªã¾ã¾ç™ºä½œã‚’æ­¢ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹", "ä¸»ã«å¤–æ¥ã§ã®ä½¿ç”¨ãŒæ¨å¥¨ã•ã‚Œã‚‹"],
                        answer: "GABA_Aå—å®¹ä½“ã‚’ç›´æ¥é–‹å£ã•ã›ã€æ·±ã„é®é™ã€œæ˜ç¡çŠ¶æ…‹ã¸å°ã",
                        feedbackTitle: "æ­£è§£ï¼",
                        feedbackText: "ãã®é€šã‚Šï¼ã“ã®ãƒ•ã‚§ãƒ¼ã‚ºã§ã¯â€œæ²ˆã‚ã‚‹â€åŒ»ç™‚ã«ãªã‚‹ã€‚å¼·åŠ›ãªæŠ‘åˆ¶ä½œç”¨ã¨å…±ã«ã€å‘¼å¸æŠ‘åˆ¶ãƒ»å¾ªç’°æŠ‘åˆ¶ã‚’å¼•ãèµ·ã“ã™ãŸã‚ã€ICUç®¡ç†ä¸‹ã§ã®ä½¿ç”¨ãŒå¿…é ˆã ã€‚",
                        supplementary: [
                            "**ãƒã‚ªãƒšãƒ³ã‚¿ãƒ¼ãƒ«:** ãƒãƒ«ãƒ“ãƒ„ãƒ¼ãƒ«é…¸ç³»ã®é™æ³¨éº»é…”è–¬ã§ã€é›£æ²»æ€§ã¦ã‚“ã‹ã‚“é‡ç©ï¼ˆRSEï¼‰ã«å¯¾ã—ã¦å¼·åŠ›ãªæŠ‘åˆ¶ä½œç”¨ã‚’ç™ºæ®ã—ã¾ã™ã€‚",
                            "**å‰¯ä½œç”¨ã¨ç®¡ç†:** ãã®å¼·åŠ›ãªä½œç”¨ã‚†ãˆã«ã€å‘¼å¸æŠ‘åˆ¶ã‚„å¾ªç’°æŠ‘åˆ¶ã¨ã„ã£ãŸé‡ç¯¤ãªå‰¯ä½œç”¨ã®ãƒªã‚¹ã‚¯ãŒé«˜ãã€é›†ä¸­æ²»ç™‚å®¤ï¼ˆICUï¼‰ã§ã®å³é‡ãªç®¡ç†ï¼ˆburst suppressionå°å…¥ãªã©ï¼‰ãŒå¿…è¦ã§ã™ã€‚"
                        ]
                    }
                ]
            },
            {
                chapter: "ã‘ã„ã‚Œã‚“æŒç¶šæ™‚é–“ã¨å¾Œéºç—‡ãƒªã‚¹ã‚¯",
                questions: [
                    {
                        text: "ã‘ã„ã‚Œã‚“ãŒ30åˆ†ä»¥ä¸Šç¶šã„ãŸå ´åˆã€MRIã§æµ·é¦¬ã®é«˜ä¿¡å·åŸŸãŒè¦‹ã‚‰ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹ã¨è¨€ã£ã¦ã„ãŸã­ã€‚ã“ã‚Œã¯å°†æ¥çš„ã«ä½•ã®ãƒªã‚¹ã‚¯ã®äºˆå…†ã¨ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
                        choices: ["è…æ©Ÿèƒ½éšœå®³", "å¿ƒè‡“ç—…", "ã¦ã‚“ã‹ã‚“ç™ºç—‡ãƒªã‚¹ã‚¯ã‚„è¨˜æ†¶éšœå®³", "å‘¼å¸å™¨ç–¾æ‚£"],
                        answer: "ã¦ã‚“ã‹ã‚“ç™ºç—‡ãƒªã‚¹ã‚¯ã‚„è¨˜æ†¶éšœå®³",
                        feedbackTitle: "æ­£è§£ï¼",
                        feedbackText: "ãã®é€šã‚Šï¼è„³ã¸ã®å½±éŸ¿ã¯ç‰¹ã«é‡è¦ã ã€‚ã“ã‚Œã¯å°†æ¥çš„ãªã¦ã‚“ã‹ã‚“ç™ºç—‡ãƒªã‚¹ã‚¯ã‚„è¨˜æ†¶éšœå®³ã®äºˆå…†ã¨ã‚‚ãªã‚‹ã€‚",
                        supplementary: [
                            "**è„³ã¸ã®å½±éŸ¿:** 30åˆ†ä»¥ä¸Šã®ã‘ã„ã‚Œã‚“æŒç¶šã¯ã€ç¥çµŒç´°èƒã®ä»£è¬éšœå®³ã€ã‚¢ãƒãƒˆãƒ¼ã‚·ã‚¹ï¼ˆç´°èƒæ­»ï¼‰ã€ç¥çµŒå¤‰æ€§ã‚’å¼•ãèµ·ã“ã™æ˜ç¢ºãªãƒªã‚¹ã‚¯ãŒã‚ã‚‹ã‚“ã ã€‚",
                            "**æµ·é¦¬ã¨è¨˜æ†¶:** æµ·é¦¬ã¯è¨˜æ†¶å½¢æˆã«é‡è¦ãªå½¹å‰²ã‚’æœãŸã™è„³ã®éƒ¨ä½ã ã‚ˆã€‚ã“ã“ã«ç•°å¸¸æ‰€è¦‹ãŒè¦‹ã‚‰ã‚Œã‚‹ã¨ã€å°†æ¥çš„ã«ã¦ã‚“ã‹ã‚“ã®ç™ºç—‡ã‚„è¨˜æ†¶éšœå®³ã«ã¤ãªãŒã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‚“ã ã€‚"
                        ]
                    },
                    {
                        text: "ã€Œå›ãŒ5åˆ†ã§å‹•ã‘ã‚‹ã‹ã©ã†ã‹ãŒã€5å¹´å¾Œã®ãã®å­ã®è„³ã‚’å·¦å³ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã‚“ã ã‚ˆã€ã¨è¨€ã£ã¦ã„ãŸã­ã€‚ã“ã‚Œã¯ã€ã¦ã‚“ã‹ã‚“é‡ç©çŠ¶æ…‹ã®æ²»ç™‚ã«ãŠã„ã¦ä½•ãŒæœ€ã‚‚é‡è¦ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºå”†ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ",
                        choices: ["æ‚£è€…ã®å¹´é½¢", "æ²»ç™‚è–¬ã®ç¨®é¡", "æ—©æœŸè¨ºæ–­ã¨æ—©æœŸä»‹å…¥", "å®¶æ—ã®å”åŠ›"],
                        answer: "æ—©æœŸè¨ºæ–­ã¨æ—©æœŸä»‹å…¥",
                        feedbackTitle: "æ­£è§£ï¼",
                        feedbackText: "ãã®é€šã‚Šï¼æ™‚é–“ã¨ã®æˆ¦ã„ãªã‚“ã ã€‚ã‘ã„ã‚Œã‚“ã‚’æ­¢ã‚ã‚‹ã€ã¨ã„ã†ã®ã¯ã€ã„ã¾ã®ç™ºä½œã‚’æ­¢ã‚ã‚‹ã ã‘ã§ãªãã€â€œãã®å­ã®ã“ã‚Œã‹ã‚‰ã®äººç”Ÿã‚’å®ˆã‚‹â€ã¨ã„ã†ã“ã¨ãªã‚“ã ã€‚",
                        supplementary: [
                            "**æ™‚é–“ä¾å­˜æ€§:** ã‘ã„ã‚Œã‚“é‡ç©çŠ¶æ…‹ã®æ²»ç™‚ã¯ã€æ™‚é–“ã¨ã®æˆ¦ã„ã ã€‚ç™ºä½œãŒé•·å¼•ãã»ã©è„³ã¸ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ãŒè“„ç©ã—ã€å¾Œéºç—‡ã®ãƒªã‚¹ã‚¯ãŒé«˜ã¾ã‚‹ã‚“ã ã€‚",
                            "**ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¿ã‚¤ãƒ :** ç‰¹ã«ãƒ™ãƒ³ã‚¾ã‚¸ã‚¢ã‚¼ãƒ”ãƒ³ç³»ã®ç¬¬ä¸€é¸æŠè–¬ã‚’5åˆ†ä»¥å†…ã«æŠ•ä¸ã™ã‚‹ã“ã¨ã¯ã€ç™ºä½œã‚’æ—©æœŸã«çµ‚æ¯ã•ã›ã€ç¥çµŒç´°èƒã®æå‚·ã‚’é˜²ããŸã‚ã®ã€Œã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¿ã‚¤ãƒ ã€ã¨ã•ã‚Œã¦ã„ã‚‹ã‚“ã ã€‚"
                        ]
                    }
                ]
            }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let xp = 0;
        let level = 1;
        let incorrectAnswers = [];
        let shuffledQuestions = [];
        let questionsOrder = []; // ç« ã®é †åºã‚’ç®¡ç†

        const startGameBtn = document.getElementById('start-game-btn');
        const gameIntroDiv = document.getElementById('game-intro');
        const gameAreaDiv = document.getElementById('game-area');
        const questionDisplayDiv = document.getElementById('question-display');
        const questionText = document.getElementById('question-text');
        const answerChoicesDiv = document.getElementById('answer-choices');
        const feedbackDisplayDiv = document.getElementById('feedback-display');
        const feedbackTitle = document.getElementById('feedback-title');
        const feedbackText = document.getElementById('feedback-text');
        const supplementaryList = document.getElementById('supplementary-list'); // è£œè¶³å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆã®ãƒªã‚¹ãƒˆ
        const nextQuestionBtn = document.getElementById('next-question-btn');
        const progressBar = document.getElementById('progress-bar');
        const xpLevelDisplay = document.getElementById('xp-level');
        const gameEndDiv = document.getElementById('game-end');
        const finalScorePara = document.getElementById('final-score');
        const finalXpLevelPara = document.getElementById('final-xp-level');
        const badgesEarnedDiv = document.getElementById('badges-earned');
        const badgeList = document.getElementById('badge-list');
        const incorrectAnswersSummaryDiv = document.getElementById('incorrect-answers-summary');
        const weaknessFeedbackPara = document.getElementById('weakness-feedback');
        const incorrectList = document.getElementById('incorrect-list');
        const reviewModeBtn = document.getElementById('review-mode-btn');
        const restartGameBtn = document.getElementById('restart-game-btn');
        const shuffleQuestionsCheckbox = document.getElementById('shuffle-questions');
        const shuffleChoicesCheckbox = document.getElementById('shuffle-choices');

        // XP thresholds for leveling up (example)
        const levelThresholds = [0, 50, 150, 300, 500, 800, 1200, 1700, 2300, 3000, 4000];
        const titles = ["è¦‹ç¿’ã„ç ”ä¿®åŒ»", "çŸ¥è­˜ã®æ¢æ±‚è€…", "ã¦ã‚“ã‹ã‚“é‡ç©ã®æ£®ã®æ­©ãæ–¹", "çœŸå®Ÿã‚’è¦‹æŠœãè€…", "ã‚»ãƒ•ã‚¡ãƒ«ã‚¹ã®è³¢è€…"];

        // Badges (example)
        const badges = {
            perfectGame: { name: "ã¦ã‚“ã‹ã‚“é‡ç©ãƒã‚¹ã‚¿ãƒ¼", description: "å…¨å•æ­£è§£ã—ã¾ã—ãŸï¼" },
            quickLearner: { name: "è¿…é€Ÿå¯¾å¿œã®è¨¼", description: "ä¸æ­£è§£ãŒ3å•æœªæº€ã§ã—ãŸï¼" }
        };
        let earnedBadges = [];

        // Function to shuffle an array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Swap elements
            }
            return array;
        }

        // Function to get the current question based on shuffled order
        function getCurrentQuestion() {
            // shuffledQuestionsã¯ã€gameDataã®å…¨å•é¡Œã‚’ãƒ•ãƒ©ãƒƒãƒˆã«ã—ãŸé…åˆ—ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ãŸã‚‚ã®
            const flatQuestionIndex = shuffledQuestions[currentQuestionIndex];
            let chapterAccumulatedQuestions = 0;
            for (let i = 0; i < gameData.length; i++) {
                const chapterQuestionsCount = gameData[i].questions.length;
                if (flatQuestionIndex < chapterAccumulatedQuestions + chapterQuestionsCount) {
                    return gameData[i].questions[flatQuestionIndex - chapterAccumulatedQuestions];
                }
                chapterAccumulatedQuestions += chapterQuestionsCount;
            }
            return null; // Should not happen if indices are correct
        }

        // Function to update XP and Level
        function updateXpAndLevel(gainedXp) {
            xp += gainedXp;
            let newLevel = level;
            for (let i = 0; i < levelThresholds.length - 1; i++) {
                if (xp >= levelThresholds[i] && xp < levelThresholds[i + 1]) {
                    newLevel = i + 1;
                    break;
                } else if (xp >= levelThresholds[levelThresholds.length - 1]) {
                    newLevel = levelThresholds.length;
                    break;
                }
            }
            level = newLevel;
            const currentTitle = titles[Math.min(level - 1, titles.length - 1)];
            xpLevelDisplay.textContent = `XP: ${xp} | ãƒ¬ãƒ™ãƒ«: ${level} | ç§°å·: ${currentTitle}`;
        }

        // Function to update the progress bar
        function updateProgressBar() {
            const totalQuestions = gameData.reduce((sum, chapter) => sum + chapter.questions.length, 0);
            const progress = (currentQuestionIndex / totalQuestions) * 100;
            progressBar.style.width = `${progress}%`;
            progressBar.textContent = `${Math.round(progress)}%`;
        }

        // Function to display the current question
        function displayQuestion() {
            const question = getCurrentQuestion();
            if (!question) {
                endGame();
                return;
            }

            questionText.textContent = question.text;
            answerChoicesDiv.innerHTML = ''; // Clear previous choices

            let choicesToDisplay = [...question.choices];
            if (shuffleChoicesCheckbox.checked) {
                 choicesToDisplay = shuffleArray(choicesToDisplay);
            }

            choicesToDisplay.forEach(choice => {
                const button = document.createElement('button');
                button.textContent = choice;
                button.classList.add('bg-blue-200', 'hover:bg-blue-300', 'text-blue-800', 'font-semibold', 'py-2', 'px-4', 'rounded-md', 'text-left');
                button.onclick = () => checkAnswer(choice);
                answerChoicesDiv.appendChild(button);
            });

            feedbackDisplayDiv.classList.add('hidden');
            questionDisplayDiv.classList.remove('hidden');
            nextQuestionBtn.classList.add('hidden');
            updateProgressBar();
        }

        // Function to check the answer
        function checkAnswer(selectedChoice) {
            const question = getCurrentQuestion();
            const isCorrect = selectedChoice === question.answer;

            answerChoicesDiv.querySelectorAll('button').forEach(button => {
                button.disabled = true; // Disable buttons after selection
                if (button.textContent === question.answer) {
                    button.classList.remove('bg-blue-200', 'hover:bg-blue-300', 'bg-red-500'); // Remove other colors
                    button.classList.add('bg-green-500', 'text-white'); // Correct answer highlight
                } else if (button.textContent === selectedChoice) {
                     button.classList.remove('bg-blue-200', 'hover:bg-blue-300', 'bg-green-500'); // Remove other colors
                    button.classList.add('bg-red-500', 'text-white'); // Incorrect answer highlight
                } else {
                    button.classList.remove('bg-blue-200', 'hover:bg-blue-300', 'bg-green-500', 'bg-red-500'); // Remove other colors
                    button.classList.add('bg-gray-300', 'text-gray-700'); // Dim other options
                }
            });

            questionDisplayDiv.classList.add('hidden');
            feedbackDisplayDiv.classList.remove('hidden');
            nextQuestionBtn.classList.remove('hidden');

            if (isCorrect) {
                score++;
                updateXpAndLevel(10); // Award 10 XP for correct answer
                feedbackTitle.textContent = "æ­£è§£ï¼";
                feedbackTitle.classList.remove('text-red-700');
                feedbackTitle.classList.add('text-green-700');
                feedbackText.textContent = `ãã®é€šã‚Šï¼`;
            } else {
                incorrectAnswers.push({
                    question: question.text,
                    yourAnswer: selectedChoice,
                    correctAnswer: question.answer,
                    feedback: question.feedbackText // feedbackTextã‚’ãã®ã¾ã¾è¡¨ç¤º
                });
                 updateXpAndLevel(5); // Award 5 XP for incorrect answer (partial learning)
                feedbackTitle.textContent = "æ®‹å¿µ...";
                 feedbackTitle.classList.remove('text-green-700');
                feedbackTitle.classList.add('text-red-700');
                feedbackText.textContent = question.feedbackText; // ä¸æ­£è§£æ™‚ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ†ã‚­ã‚¹ãƒˆ
            }

            // æ­£è§£ãƒ»ä¸æ­£è§£ã«é–¢ã‚ã‚‰ãšè£œè¶³å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆã‚’è¡¨ç¤º
            supplementaryList.innerHTML = ''; // Clear previous supplementary points
            if (question.supplementary) { // Check if supplementary exists
                question.supplementary.forEach(point => {
                    const li = document.createElement('li');
                    li.innerHTML = point; // Use innerHTML to render bold/italics from markdown
                    supplementaryList.appendChild(li);
                });
            }
        }

        // Function to move to the next question
        function nextQuestion() {
            currentQuestionIndex++;
            updateProgressBar();
            const totalQuestions = gameData.reduce((sum, chapter) => sum + chapter.questions.length, 0);
            if (currentQuestionIndex < totalQuestions) {
                displayQuestion();
            } else {
                endGame();
            }
        }

         // Function to end the game
        function endGame() {
            gameAreaDiv.classList.add('hidden');
            gameEndDiv.classList.remove('hidden');

            const totalQuestions = gameData.reduce((sum, chapter) => sum + chapter.questions.length, 0);
            finalScorePara.textContent = `æœ€çµ‚ã‚¹ã‚³ã‚¢: ${score} / ${totalQuestions}`;
            finalXpLevelPara.textContent = `æœ€çµ‚XP: ${xp} | æœ€çµ‚ãƒ¬ãƒ™ãƒ«: ${level} | ç§°å·: ${titles[Math.min(level - 1, titles.length - 1)]}`;

            // Award badges
            earnedBadges = [];
            if (score === totalQuestions) {
                earnedBadges.push(badges.perfectGame);
            }
            if (incorrectAnswers.length < 3) {
                 earnedBadges.push(badges.quickLearner);
            }

            badgeList.innerHTML = '';
            if (earnedBadges.length > 0) {
                earnedBadges.forEach(badge => {
                    const li = document.createElement('li');
                    li.textContent = `ğŸ† ${badge.name}: ${badge.description}`;
                    badgeList.appendChild(li);
                });
            } else {
                badgeList.innerHTML = '<li>ãƒãƒƒã‚¸ã®ç²å¾—ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</li>';
            }


            // Display incorrect answers summary
            incorrectList.innerHTML = '';
            if (incorrectAnswers.length > 0) {
                 weaknessFeedbackPara.textContent = `å›ã¯${incorrectAnswers.length}å•ã‚’é–“é•ãˆã¦ã—ã¾ã£ãŸã­ã€‚ä»¥ä¸‹ã®å•é¡Œã‚’è¦‹ç›´ã—ã¦ã€ã‚‚ã£ã¨å¼·ããªã‚ã†ï¼`;
                incorrectAnswersSummaryDiv.classList.remove('hidden');
                incorrectAnswers.forEach(item => {
                    const li = document.createElement('li');
                    li.innerHTML = `**å•é¡Œ:** ${item.question}<br>ã‚ãªãŸã®è§£ç­”: ${item.yourAnswer}<br>æ­£è§£: ${item.correctAnswer}<br>**è§£èª¬:** ${item.feedback}`;
                    incorrectList.appendChild(li);
                });

            } else {
                 weaknessFeedbackPara.textContent = "å…¨å•æ­£è§£ã ï¼ç´ æ™´ã‚‰ã—ã„ï¼å›ã¯ã€Œã¦ã‚“ã‹ã‚“é‡ç©ã‚¯ã‚¤ã‚ºã€ã®ãƒã‚¹ã‚¿ãƒ¼ã ã­ï¼";
                 incorrectAnswersSummaryDiv.classList.remove('hidden'); // Still show the perfect score message
            }
        }

        // Function to start a new game
        function startNewGame(isReviewMode = false) {
            currentQuestionIndex = 0;
            score = 0;
            xp = 0;
            level = 1;
            incorrectAnswers = [];
            earnedBadges = [];

            gameIntroDiv.classList.add('hidden');
            gameEndDiv.classList.add('hidden');
            gameAreaDiv.classList.remove('hidden');
            feedbackDisplayDiv.classList.add('hidden'); // Hide feedback at the start

            updateXpAndLevel(0); // Initialize XP and Level display
            updateProgressBar(); // Initialize progress bar

            // å…¨å•é¡Œã‚’ãƒ•ãƒ©ãƒƒãƒˆãªé…åˆ—ã¨ã—ã¦æº–å‚™
            let allQuestions = [];
            gameData.forEach(chapter => {
                chapter.questions.forEach((q, qIndex) => {
                    allQuestions.push({ chapterIndex: gameData.indexOf(chapter), questionIndex: qIndex, questionData: q });
                });
            });

            if (shuffleQuestionsCheckbox.checked) {
                shuffledQuestions = shuffleArray(Array.from({ length: allQuestions.length }, (_, i) => i));
            } else {
                shuffledQuestions = Array.from({ length: allQuestions.length }, (_, i) => i);
            }

            // getCurrentQuestionãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã‚ˆã†ã«ã€shuffledQuestionsã¯ãƒ•ãƒ©ãƒƒãƒˆãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®é…åˆ—ã¨ã™ã‚‹
            // getCurrentQuestionå†…ã§ã€ãã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒã©ã®ãƒãƒ£ãƒ—ã‚¿ãƒ¼ã®ã©ã®å•é¡Œã«å½“ãŸã‚‹ã‹ã‚’è¨ˆç®—ã™ã‚‹

            if (isReviewMode) {
                 alert("å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã¯ç¾åœ¨é–‹ç™ºä¸­ã§ã™ã€‚ä»£ã‚ã‚Šã«é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã§å†æŒ‘æˆ¦ã—ã¾ã™ã€‚");
                 startNewGame(false); // Fallback to normal restart
                 return;
            }

            displayQuestion(); // Start with the first question
        }


        // Event Listeners
        startGameBtn.addEventListener('click', () => startNewGame());
        nextQuestionBtn.addEventListener('click', nextQuestion);
        restartGameBtn.addEventListener('click', () => startNewGame());
        reviewModeBtn.addEventListener('click', () => startNewGame(true)); // Pass true for review mode

        // Initial setup
        updateXpAndLevel(0); // Display initial XP and Level
    </script>
</body>
</html>
